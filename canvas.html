<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="user-scalable=0">
		<title>Canvas3D</title>
		<style>
			html,body{
				height:100%;
				width:100%;
			}
			body{
				padding:0;
				margin:0;
				border:0;
			}
		</style>
	</head>

	<body>
		<canvas id="canvas"></canvas>
		<script>

			/*
			** Structs
			*/
			function Camera(positionX,positionY,positionZ,angleX,angleY,angleZ){
				this.px = positionX;
				this.py = positionY;
				this.pz = positionZ;
				this.ax = angleX;
				this.ay = angleY;
				this.az = angleZ;
				return this;
			}

			function Vector(x,y,z){
				this.x = x;
				this.y = y;
				this.z = z;
				this.x2d = null;
				this.y2d = null;
				return this;
			}

			/*
			** Canvas Functions
			*/

			function CanvasInitialize(canvasID){
				var canvas = document.getElementById(canvasID);
				canvas.width = document.body.clientWidth;
				canvas.height = document.body.clientHeight;
				var ctx = canvas.getContext("2d");
				ctx.fillStyle = "#000000";
				return ctx;
			}

			/*
			** Drawing Functions
			*/

			function drawMark(ctx,x,y){
				ctx.fillRect(x-3,y-3,6,6);
			}

			function drawLine(ctx,x1,y1,x2,y2){
				ctx.beginPath();
				ctx.moveTo(x1,y1);
				ctx.lineTo(x2,y2);
				ctx.stroke();
				ctx.closePath();
			}

			function prespectiveProjection(camera,vector){
				vector.x2d = (vector.x - camera.px) / (vector.z - camera.pz);
				vector.x2d = (vector.y - camera.py) / (vector.z - camera.pz);
			}

			/*
			** Variables
			*/

			var cam1 = Camera(-0.2,3,0.5,0,0,0);

			var vecList = [new Vector(0 ,0 ,0 ),
						   new Vector(0 ,50,0 ),
						   new Vector(50,0 ,0 ),
						   new Vector(50,50,0 ),
						   new Vector(0 ,0 ,50),
						   new Vector(0 ,50,50),
						   new Vector(50,0 ,50),
						   new Vector(50,50,50)];

			var lineStart = [0,1,2,3,4,5,6,7,0,1,2,3];
			var lineEnd   = [1,2,3,0,5,6,7,4,4,5,6,7];

			var ctx = CanvasInitialize("canvas");

			function main()
			{
				ctx.clearRect(0,0,canvas.width,canvas.height);

				//Process Vectors
				for(var i = 0;i<vecList.length;i++){
					prespectiveProjection(cam1,vecList[i]);
					drawMark(ctx,vecList[i].x2d,vecList[i].y2d);
				}

				//Process Lines
				for(var i = 0;i<lineStart.length;i++){
					drawLine(ctx,
					         vecList[lineStart[i]].x2d,
							 vecList[lineStart[i]].y2d,
							 vecList[lineEnd  [i]].x2d,
							 vecList[lineEnd  [i]].y2d);
				}

				console.log("x=" + cam1.px + "       y=" + cam1.py + "          z=" + cam1.pz);
				requestAnimationFrame(main);
			}

			requestAnimationFrame(main);

			window.onkeydown=function(){
				if(event.keyCode == 65){
					//alert('a');
					cam1.px -= 1;
				}
				else if(event.keyCode == 68){
					//alert('d');
					cam1.px += 1;
				}
				else if(event.keyCode == 74){
					//alert('j');
					cam1.py -= 1;
				}
				else if(event.keyCode == 75){
					//alert('k');
					cam1.py += 1;
				}
				else if(event.keyCode == 83){
					//alert('s');
					cam1.pz -= 1;
				}
				else if(event.keyCode == 87){
					//alert('w');
					cam1.pz += 1;
				}
			}
		</script>
	</body>
</html>